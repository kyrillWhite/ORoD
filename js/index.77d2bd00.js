(function(){"use strict";var e={1681:function(e,t,n){var o=n(9242),a=n(3396);function s(e,t,n,o,s,r){const l=(0,a.up)("main-part");return(0,a.wg)(),(0,a.j4)(l)}var r=n(7139);const l={class:"page"},i=(0,a._)("header",{class:"header"},[(0,a._)("h1",{class:"header__logo"}," ORoD ")],-1),d={class:"pop-up-error"},c={class:"pop-up-error__error_text"},u=["onClick"],m={class:"page__content"},h={class:"page__main"},_={class:"page__part"},p=(0,a._)("div",{class:"page__part_title"}," ЗАГРУЗКА ФАЙЛОВ ",-1),g={class:"page__part_content"},k={class:"page__part"},f=(0,a._)("div",{class:"page__part_title"}," НАСТРОЙКА ПАРАМЕТРОВ ",-1),y={class:"page__part_content"},v={class:"page__part"},w=(0,a._)("div",{class:"page__part_title"}," ОНТОЛОГИЯ ",-1),b={class:"page__part_content"},D={class:"page__part"},O=(0,a._)("div",{class:"page__part_title"}," ДОКУМЕНТЫ ",-1),N={class:"page__part_content"},C=(0,a._)("footer",{class:"footer"},[(0,a.Uk)(" 2022 - kyrillWhite"),(0,a._)("br"),(0,a.Uk)(" kiribel2000@gmail.com ")],-1);function x(e,t,n,o,s,x){const R=(0,a.up)("LoadPart"),B=(0,a.up)("ParameterPart"),P=(0,a.up)("DocumentPart");return(0,a.wg)(),(0,a.iD)("div",l,[i,(0,a._)("div",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.errors,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"pop-up-error__error",key:e.id},[(0,a._)("div",c,(0,r.zw)(e.text),1),(0,a._)("button",{class:"button__close",onClick:t=>x.removeError(e.id)},null,8,u)])))),128))]),(0,a._)("div",m,[(0,a._)("main",h,[(0,a._)("div",_,[p,(0,a._)("div",g,[(0,a.Wm)(R,{onOnLoadOnt:x.updateOntology,onOnLoadTxt:x.pushDocument,onLoadError:x.outputError},null,8,["onOnLoadOnt","onOnLoadTxt","onLoadError"])])]),(0,a._)("div",k,[f,(0,a._)("div",y,[(0,a.Wm)(B,{"p-n":s.N,"p-k":s.K,"p-b":s.B,"has-documents":0!=s.documents.length,"has-ontology":null!=s.ontology,onRankingAll:x.rankingAll,onChangedN:x.changeN,onChangedK:x.changeK,onChangedB:x.changeB,onRankingError:x.outputError},null,8,["p-n","p-k","p-b","has-documents","has-ontology","onRankingAll","onChangedN","onChangedK","onChangedB","onRankingError"])])]),(0,a._)("div",v,[w,(0,a._)("div",b,(0,r.zw)(s.ontology?s.ontology.name:"ОНТОЛОГИЯ НЕ ЗАГРУЖЕНА"),1)]),(0,a._)("div",D,[O,(0,a._)("div",N,[(0,a.Wm)(P,{"pr-documents":s.documents,onFindRank:x.findRank,onRemoveDocument:x.removeDocument,onRankingError:x.outputError},null,8,["pr-documents","onFindRank","onRemoveDocument","onRankingError"])])])])]),C])}n(7658);var R=n(7327);class B{constructor(e){(0,R.Z)(this,"text",null),(0,R.Z)(this,"id",null),this.text=e,this.id=Math.random()}}const P={class:"document"},A=(0,a._)("th",{class:"document__header",scope:"col"},"№",-1),E=(0,a._)("th",{class:"document__header",scope:"col"},"Инф.",-1),F=(0,a._)("th",{class:"document__header",scope:"col"},"Удал.",-1);function I(e,t,n,o,s,l){const i=(0,a.up)("DocumentElement");return(0,a.wg)(),(0,a.iD)("table",P,[(0,a._)("thead",null,[(0,a._)("tr",null,[A,(0,a._)("th",{class:"document__header document__name",scope:"col",onClick:t[0]||(t[0]=(...e)=>l.sortByNameClicked&&l.sortByNameClicked(...e))},[(0,a.Uk)(" Название документа "),(0,a._)("span",null,(0,r.zw)(s.sortSymbols[s.sortByName]),1)]),(0,a._)("th",{class:"document__header",scope:"col",onClick:t[1]||(t[1]=(...e)=>l.sortByRankClicked&&l.sortByRankClicked(...e))},[(0,a.Uk)(" Ранг "),(0,a._)("span",null,(0,r.zw)(s.sortSymbols[s.sortByRank]),1)]),E,F])]),(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.sortedDocuments,((e,t)=>((0,a.wg)(),(0,a.j4)(i,{key:e.id,document:e,index:t+1,onDocDetailsOpened:l.openDocumentDetails,onDocDetailsClosed:l.closeDocumentDetails,onFindRank:l.findRank,onRemoveDocument:l.removeDocument},null,8,["document","index","onDocDetailsOpened","onDocDetailsClosed","onFindRank","onRemoveDocument"])))),128))])])}const $={class:"document__field"},K={class:"document__field document__center"},L={class:"document__option document__center"},j={class:"document__option document__center"},S={colspan:"100"},U={key:0,class:"document__details"},Z={class:"document__menu"},z={class:"document__details_content"},W={key:0,class:"source-text"};function T(e,t,n,o,s,l){const i=(0,a.up)("IntermediateResult"),d=(0,a.up)("RankResult");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("tr",{class:(0,r.C_)(l.titleClasses)},[(0,a._)("th",{class:(0,r.C_)(["document__field",{document__field_selected:n.document.detailsAreOpened}]),scope:"row"},(0,r.zw)(n.index),3),(0,a._)("td",$,(0,r.zw)(n.document.name),1),(0,a._)("td",K,(0,r.zw)(n.document.ranking?n.document.ranking.rank.toFixed(3):"-"),1),(0,a._)("td",L,[(0,a._)("button",{class:(0,r.C_)({button__close:n.document.detailsAreOpened,button__more:!n.document.detailsAreOpened}),onClick:t[0]||(t[0]=(...e)=>l.detailsMenuClick&&l.detailsMenuClick(...e))},null,2)]),(0,a._)("td",j,[(0,a._)("button",{class:"button__remove",onClick:t[1]||(t[1]=(...e)=>l.removeDocument&&l.removeDocument(...e))})])],2),(0,a._)("tr",null,[(0,a._)("td",S,[n.document.detailsAreOpened?((0,a.wg)(),(0,a.iD)("div",U,[(0,a._)("div",Z,[(0,a._)("button",{class:(0,r.C_)(["document__menu_item tab",{tab__active:1==s.openedDetailsPart}]),onClick:t[2]||(t[2]=e=>l.openDetailsPart(1))}," Исходный текст ",2),(0,a._)("button",{class:(0,r.C_)(["document__menu_item tab",l.menuTabClasses(2)]),onClick:t[3]||(t[3]=e=>l.openDetailsPart(2))}," Промеж. результат ",2),(0,a._)("button",{class:(0,r.C_)(["document__menu_item tab",l.menuTabClasses(3)]),onClick:t[4]||(t[4]=e=>l.openDetailsPart(3))}," Результат оценки ",2)]),(0,a._)("div",z,[1==s.openedDetailsPart?((0,a.wg)(),(0,a.iD)("div",W,(0,r.zw)(n.document.text),1)):2==s.openedDetailsPart?((0,a.wg)(),(0,a.j4)(i,{key:1,document:n.document},null,8,["document"])):3==s.openedDetailsPart?((0,a.wg)(),(0,a.j4)(d,{key:2,document:n.document,onFindRank:l.findRank},null,8,["document","onFindRank"])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0)])])],64)}const M={class:"intermediate-result"},J=(0,a._)("div",{class:"intermediate-result__title"}," Привязавшаяся онтология: ",-1),H={class:"intermediate-result"},Y=(0,a._)("div",{class:"intermediate-result__title"}," Привязавшиеся понятия: ",-1),q={class:"intermediate-result"},V=(0,a._)("div",{class:"intermediate-result__title"}," Отфильтрованные предложения: ",-1);function X(e,t,n,o,s,l){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",M,[J,(0,a._)("button",{class:"button",onClick:t[0]||(t[0]=(...e)=>l.downloadAttachedOntology&&l.downloadAttachedOntology(...e))}," Скачать ")]),(0,a._)("div",H,[Y,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.document?.terms,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t},(0,r.zw)(`${t+1}. ${e}`),1)))),128))]),(0,a._)("div",q,[V,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.document?.sentences,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t},[(0,a.Uk)((0,r.zw)(`${t+1}. `)+" ",1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.markedText,((e,t)=>((0,a.wg)(),(0,a.iD)("span",{key:t,class:(0,r.C_)({"marked-text":e.mark})},(0,r.zw)(e.text),3)))),128)),(0,a.Uk)(". ")])))),128))])])}var G={name:"IntermediateResult",props:{document:Object},methods:{downloadAttachedOntology(){let e=JSON.stringify({nodes:this.document.attachedOntology.nodes,relations:this.document.attachedOntology.relations}),t=`${this.document.attachedOntology.name.replace(".ont","")}_${(new Date).toLocaleString().replaceAll(/[ ,:.]/g,"_")}.ont`,n=new File([e],{name:t,type:"octet/stream"}),o=window.URL.createObjectURL(n);var a=document.createElement("a");document.body.appendChild(a),a.href=o,a.download=t,a.click(),window.URL.revokeObjectURL(o),document.body.removeChild(a)}}},Q=n(89);const ee=(0,Q.Z)(G,[["render",X]]);var te=ee;const ne={key:0,class:"rank-result"},oe=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{class:"rank-result__start rank-result__header",scope:"col"}," Понятие 1 "),(0,a._)("th",{class:"rank-result__start rank-result__header",scope:"col"}," Понятие 2 "),(0,a._)("th",{class:"rank-result__start rank-result__header",scope:"col"},[(0,a.Uk)(" Степ. близости (S"),(0,a._)("sub",null,"ij"),(0,a.Uk)(") ")]),(0,a._)("th",{class:"rank-result__start rank-result__header",scope:"col"},[(0,a.Uk)(" Норм. степ. близости (S'"),(0,a._)("sub",null,"ij"),(0,a.Uk)(") ")]),(0,a._)("th",{class:"rank-result__start rank-result__header",scope:"col"},[(0,a.Uk)(" Кол-во путей (P'"),(0,a._)("sub",null,"ij"),(0,a.Uk)(") ")]),(0,a._)("th",{class:"rank-result__start rank-result__header",scope:"col"}," Мощность понятия (Ub) "),(0,a._)("th",{class:"rank-result__start rank-result__header",scope:"col"},[(0,a.Uk)(" Вес дуги (E"),(0,a._)("sub",null,"ij"),(0,a.Uk)(") ")]),(0,a._)("th",{class:"rank-result__start rank-result__header",scope:"col"},[(0,a.Uk)(" B"),(0,a._)("sub",null,"i*")]),(0,a._)("th",{class:"rank-result__start rank-result__header",scope:"col"},[(0,a.Uk)(" B"),(0,a._)("sub",null,"*j")])])],-1),ae={class:"rank-result__cell rank-result__start",scope:"row"},se={class:"rank-result__cell rank-result__start",scope:"row"},re={class:"rank-result__cell"},le={class:"rank-result__cell"},ie={class:"rank-result__cell"},de={class:"rank-result__cell"},ce={class:"rank-result__cell"},ue={class:"rank-result__cell"},me={class:"rank-result__cell"};function he(e,t,n,o,s,l){return n.document?.ranking?((0,a.wg)(),(0,a.iD)("table",ne,[oe,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.document.ranking.pairs,((e,t)=>((0,a.wg)(),(0,a.iD)("tr",{key:t},[(0,a._)("td",ae,(0,r.zw)(e.term1),1),(0,a._)("td",se,(0,r.zw)(e.term2),1),(0,a._)("td",re,(0,r.zw)(e.s.toFixed(3)),1),(0,a._)("td",le,(0,r.zw)(e.sNorm.toFixed(3)),1),(0,a._)("td",ie,(0,r.zw)(e.pathsCount.toFixed(3)),1),(0,a._)("td",de,(0,r.zw)(e.power.toFixed(3)),1),(0,a._)("td",ce,(0,r.zw)(e.weight.toFixed(3)),1),(0,a._)("td",ue,(0,r.zw)(e.betaI.toFixed(3)),1),(0,a._)("td",me,(0,r.zw)(e.betaJ.toFixed(3)),1)])))),128))])])):((0,a.wg)(),(0,a.iD)("button",{key:1,class:"button document__details_button",onClick:t[0]||(t[0]=(...e)=>l.findRank&&l.findRank(...e))},"Вычислить оценку"))}var _e={name:"RankResult",props:{document:Object},methods:{findRank(){this.$emit("find-rank")}}};const pe=(0,Q.Z)(_e,[["render",he]]);var ge=pe,ke={name:"DocumentElement",components:{IntermediateResult:te,RankResult:ge},props:{index:Number,document:Object},data(){return{openedDetailsPart:1}},computed:{titleClasses(){let e={};return this.document?.detailsAreOpened?e["document__field_selected"]=!0:e["document__field_odd"]=this.index%2==0,e}},methods:{detailsMenuClick(){this.$emit("doc-details-"+(this.document.detailsAreOpened?"closed":"opened"),this.document.id),this.document.detailsAreOpened&&(this.openedDetailsPart=1)},openDetailsPart(e){(this.document.attachedOntology||1==e)&&(this.openedDetailsPart=e)},findRank(){this.$emit("find-rank",this.document.id)},removeDocument(){this.$emit("remove-document",this.document.id)},menuTabClasses(e){let t={};return this.document?.attachedOntology?t["tab__active"]=this.openedDetailsPart==e:t["tab__not-active"]=!0,t}}};const fe=(0,Q.Z)(ke,[["render",T]]);var ye=fe,ve={name:"DocumentPart",components:{DocumentElement:ye},props:{prDocuments:Object},data(){return{docWithOpenedDetailsId:null,sortByName:2,sortByRank:0,sortSymbols:[" ","▼","▲"],documents:this.prDocuments}},computed:{sortedDocuments(){let e=Object.values(this.documents);return this.sortByName?e.sort(this.compareDocsByName):this.sortByRank&&e.sort(this.compareDocsByRank),e}},methods:{openDocumentDetails(e){this.docWithOpenedDetailsId&&(this.documents[this.docWithOpenedDetailsId].detailsAreOpened=!1),this.documents[e].detailsAreOpened=!0,this.docWithOpenedDetailsId=e},closeDocumentDetails(){this.documents[this.docWithOpenedDetailsId].detailsAreOpened=!1,this.docWithOpenedDetailsId=null},findRank(e){this.$emit("find-rank",e)},removeDocument(e){this.docWithOpenedDetailsId==e&&(this.docWithOpenedDetailsId=null),this.$emit("remove-document",e)},sortByNameClicked(){switch(this.sortByRank=0,this.sortByName){case 0:case 1:this.sortByName=2;break;case 2:this.sortByName=1;break}},sortByRankClicked(){switch(this.sortByName=0,this.sortByRank){case 1:this.sortByRank=2;break;case 0:case 2:this.sortByRank=1;break}},compareDocsByName(e,t){let n=0;return e.name<t.name?n=-1:e.name>t.name&&(n=1),1==this.sortByName?-1*n:n},compareDocsByRank(e,t){let n=0;return e?.ranking?.rank<t?.ranking?.rank?n=-1:e?.ranking?.rank>t?.ranking?.rank&&(n=1),1==this.sortByRank?-1*n:n}}};const we=(0,Q.Z)(ve,[["render",I]]);var be=we;const De={class:"load-part"};function Oe(e,t,n,o,s,r){const l=(0,a.up)("LoadForm");return(0,a.wg)(),(0,a.iD)("div",De,[(0,a.Wm)(l,{"load-id":0,"load-object":"онтологию",extension:".ont","multiple-files":!1,onOnLoad:r.loadOntology,onLoadError:r.loadFormError},null,8,["extension","onOnLoad","onLoadError"]),(0,a.Wm)(l,{"load-id":1,"load-object":"документы",extension:".txt","multiple-files":!0,onOnLoad:r.loadDocuments,onLoadError:r.loadFormError},null,8,["extension","onOnLoad","onLoadError"])])}class Ne{constructor(e,t,n){(0,R.Z)(this,"name",null),(0,R.Z)(this,"nodes",null),(0,R.Z)(this,"relations",null),this.name=e,this.nodes=t,this.relations=n}getCopy(){return new Ne(this.name,JSON.parse(JSON.stringify(this.nodes)),JSON.parse(JSON.stringify(this.relations)))}}var Ce=n(6184);class xe{static attachOntology(e,t,n){if(!e)throw"Empty document text";if(!t||!t.nodes||!t.relations)throw"Invalid ontology object";let o=e.split(/\. */).filter((e=>e)),a=t.nodes.map(((e,t)=>({name:e.name,index:t}))),s=this.stemOntology(a),r=o.map((e=>e.split(/([^а-яА-Яa-zA-Z0-9-]+)/))),l=o.map((e=>this.stemSentence(e.split(/[^а-яА-Яa-zA-Z0-9-]+/))));s=s.filter((e=>e.words.length>0&&l.some((t=>this.isArrayIncludeArray(t,e.words)))));let i=s.map((e=>e.sourceTerm)),d=this.getMarkedSentences(r,l,s),c=o.map(((e,t)=>({text:e,markedText:d[t],terms:i.filter(((e,n)=>this.isArrayIncludeArray(l[t],s[n].words)))}))).filter((e=>e.terms.length)),u=t.getCopy(),m=Array.apply(null,Array(u.nodes.length)).map((()=>!1));s.forEach((e=>{m[e.index]=!0}));for(let _ in u.nodes)m[_]||(u.nodes[_].name="");const h=this.findNeededNodes(u,n);return u.nodes=u.nodes.filter((e=>h.includes(e.id))),u.relations=u.relations.filter((e=>h.includes(e.source_node_id)&&h.includes(e.destination_node_id))),{attachedOntology:u,terms:i,sentences:c}}static findNeededNodes(e,t){let n={};for(let a of e.nodes)n[a.id]=[];for(let a of e.relations)n[a.source_node_id].push(a.destination_node_id);let o=new Set;for(let a of e.nodes)if(""!==a.name){let s=this.findUsedNodes(e,n,a.id,t);s.forEach((e=>o.add(e)))}return Array.from(o)}static findUsedNodes(e,t,n,o){const a={};e.nodes.forEach((e=>{a[e.id]=e.name}));let s=new Set;s.add(n);let r=[];r.push({prevs:[],depth:0,id:n});while(0!=r.length){let e=r.pop(),n=e.depth,l=e.id,i=e.prevs;""!==a[l]&&i.forEach((e=>s.add(e))),n!=o&&r.push(...t[l].map((e=>({prevs:[l,...i],depth:n+1,id:e}))))}return s}static stemOntology(e){let t=(0,Ce.newStemmer)("russian"),n=[];for(let o of e){let e=o.name.toLowerCase().split(" ").filter((e=>e)).map((e=>t.stem(e)));n.push({sourceTerm:o.name,words:e,index:o.index})}return n}static stemSentence(e){let t=(0,Ce.newStemmer)("russian");return e.map((e=>t.stem(e.toLowerCase()))).filter((e=>e))}static isArrayIncludeArray(e,t){if(t.length>e.length)return!1;for(let n=0;n<=e.length-t.length;n++){let o=e.slice(n,n+t.length);if(o.every(((e,n)=>e===t[n])))return!0}}static getMarkedSentences(e,t,n){let o=(0,Ce.newStemmer)("russian"),a=[];for(let s in e){let r=n.filter((e=>this.isArrayIncludeArray(t[s],e.words))),l=e[s].map((e=>/[^а-яА-Яa-zA-Z0-9-]+/.test(e)?null:o.stem(e.toLowerCase()))),i=e[s].map((e=>({word:e,mark:!1})));for(let e of r)for(let t in l){if(!l[t])continue;let n=parseInt(t),o=parseInt(t),a=0;while(o<l.length&&a<e.words.length&&l[o]==e.words[a])o+=2,a++;if(a==e.words.length)for(let e=n;e<=o-2;e++)i[e].mark=!0}let d=[];for(let e of i)0!=d.length&&d[d.length-1].mark==e.mark?d[d.length-1].text+=e.word:d.push({text:e.word,mark:e.mark});a.push(d)}return a}}class Re{static findRank(e,t,n,o){if(!e||!e.attachedOntology||!e.attachedOntology.nodes||!e.attachedOntology.relations)throw"Invalid document object";let a=e.attachedOntology,s=[],r=this.findWeights(e);for(let i=0;i<a.nodes.length;i++)for(let l=0;l<a.nodes.length;l++)if(a.nodes[i].name&&a.nodes[l].name&&i!=l){let d=this.semanticProximity(e,r,i,l,t,n,o);d&&s.push({term1:a.nodes[i].name,term2:a.nodes[l].name,...d})}s=this.normSemanticProximity(s);let l=s.length?s.reduce(((e,t)=>e+t.sNorm),0)/s.length:0;return{rank:l,pairs:s}}static semanticProximity(e,t,n,o,a,s,r){let l=e.attachedOntology;const i=l.nodes[n].name,d=l.nodes[o].name,c=l.nodes[n].id,u=l.nodes[o].id,m=e.sentences.map(((e,t)=>e.terms.includes(i)?t:null)).filter((e=>null!==e))[0],h=e.sentences.map(((e,t)=>e.terms.includes(d)?t:null)).filter((e=>null!==e))[0];if(void 0===m||void 0===h||Math.abs(m-h)>s)return null;let _={};for(let w of l.nodes)_[w.id]=[];for(let w of l.relations)_[w.source_node_id].push(w.destination_node_id);let p=this.findPathsCount(_,c,u,a);if(0===p)return null;let g=t[n].filter((e=>e>=r)).length,k=t[o].filter((e=>e>=r)).length,f=t[n].filter((e=>e>=r)).reduce(((e,t)=>e+t),0)/t[n].length,y=t[n][o],v=g+k?2*Math.sqrt(p)*f*y/(g+k):0;return{s:v,pathsCount:p,power:f,weight:y,betaI:g,betaJ:k}}static findPathsCount(e,t,n,o){let a=0,s=[];s.push({depth:0,id:t});while(0!=s.length){let t=s.pop(),r=t.depth,l=t.id;l==n&&a++,r!=o&&s.push(...e[l].map((e=>({depth:r+1,id:e}))))}return a}static normSemanticProximity(e){let t=[...e],n=t.reduce(((e,t)=>e.s<t.s?e:t),Number.MAX_VALUE).s,o=t.reduce(((e,t)=>e.s>t.s?e:t),Number.MIN_VALUE).s;if(0==o)for(let a in t)t[a].sNorm=0;else for(let a in t)t[a].sNorm=(t[a].s-n)/o;return t}static findWeights(e){let t=e.attachedOntology,n=t.nodes.length,o=Array(n).fill(0).map((()=>Array(n).fill(0)));for(let a=0;a<n;a++)for(let n=0;n<a;n++){let s=t.nodes[a].name,r=t.nodes[n].name;s&&r&&(o[a][n]=o[n][a]=e.sentences.filter((e=>e.terms.includes(s)&&e.terms.includes(r))).length)}return o}}class Be{constructor(e,t){(0,R.Z)(this,"id",Math.random()),(0,R.Z)(this,"name",null),(0,R.Z)(this,"text",null),(0,R.Z)(this,"ranking",null),(0,R.Z)(this,"attachedOntology",null),(0,R.Z)(this,"terms",null),(0,R.Z)(this,"sentences",null),(0,R.Z)(this,"detailsAreOpened",!1),this.name=e,this.text=t}attachOntology(e,t){try{let{attachedOntology:n,terms:o,sentences:a}=xe.attachOntology(this.text,e,t);this.attachedOntology=n,this.terms=o,this.sentences=a}catch(n){console.log(n)}}findRank(e,t,n){try{this.ranking=Re.findRank(this,e,t,n)}catch(o){console.log(o)}}}class Pe{static async loadDocument(e,t){let n=this.loadFile(e,t);return n.then((t=>new Be(e.name,t)),(()=>"Ошибка загрузки документа"))}static async loadOntology(e,t){let n=this.loadFile(e,t);return n.then((t=>new Promise(((n,o)=>{try{let o=JSON.parse(t);n(new Ne(e.name,o.nodes,o.relations))}catch{o("Ошибка загрузки онтологии")}}))),(()=>"Ошибка загрузки онтологии"))}static async loadFile(e,t){return new Promise(((n,o)=>{let a=new FileReader;a.onload=()=>{n(a.result)},a.onerror=o,a.onprogress=t,a.readAsText(e)}))}static validateFileName(e,t){let n=new RegExp(`^.+${t}$`);return e.match(n)}}const Ae={class:"load-part__element"},Ee=["for"],Fe=["id","accept","multiple"];function Ie(e,t,n,o,s,l){return(0,a.wg)(),(0,a.iD)("div",Ae,[(0,a._)("label",{class:"load-part__button button",for:`load-form_${n.loadId}`}," Загрузить "+(0,r.zw)(n.loadObject),9,Ee),(0,a._)("input",{type:"file",hidden:"",id:`load-form_${n.loadId}`,ref:`load-form_${n.loadId}`,accept:n.extension,multiple:n.multipleFiles,onChange:t[0]||(t[0]=(...e)=>l.loadFile&&l.loadFile(...e))},null,40,Fe)])}var $e={name:"LoadForm",props:{multipleFiles:Boolean,extension:String,loadId:Number,loadObject:String},methods:{loadFile(){let e=[...this.$refs[`load-form_${this.loadId}`].files];e.every((e=>Pe.validateFileName(e.name,this.extension)))?this.$emit("on-load",this.$refs[`load-form_${this.loadId}`].files):this.$emit("load-error",`Ожидался файл с расширением ${this.extension}`)}}};const Ke=(0,Q.Z)($e,[["render",Ie]]);var Le=Ke,je={name:"LoadPart",components:{LoadForm:Le},methods:{async loadOntology(e){await Pe.loadOntology(e[0],(e=>e)).then((e=>{this.$emit("on-load-ont",e)}),(e=>{this.$emit("load-error",e)}))},async loadDocuments(e){for(let t of e)await Pe.loadDocument(t,(e=>e)).then((e=>{this.$emit("on-load-txt",e)}),(e=>{this.$emit("load-error",e)}))},loadFormError(e){this.$emit("load-error",e)}}};const Se=(0,Q.Z)(je,[["render",Oe]]);var Ue=Se;const Ze={class:"parameter-part"},ze={class:"parameter-part__parameters"},We=["disabled"];function Te(e,t,n,o,s,l){const i=(0,a.up)("ParameterText");return(0,a.wg)(),(0,a.iD)("div",Ze,[(0,a._)("div",ze,[(0,a.Wm)(i,{name:"N",value:s.N,onParameterChanged:l.changeN},null,8,["value","onParameterChanged"]),(0,a.Wm)(i,{name:"K",value:s.K,onParameterChanged:l.changeK},null,8,["value","onParameterChanged"]),(0,a.Wm)(i,{name:"B",value:s.B,onParameterChanged:l.changeB},null,8,["value","onParameterChanged"])]),(0,a._)("button",{class:(0,r.C_)(["button parameter-part__ranking",{"button__not-active":!l.canRanking}]),disabled:!l.canRanking,onClick:t[0]||(t[0]=(...e)=>l.rankingAll&&l.rankingAll(...e))}," Выполнить ранжирование ",10,We)])}const Me={class:"parameter"},Je={class:"parameter__name"};function He(e,t,n,s,l,i){return(0,a.wg)(),(0,a.iD)("div",Me,[(0,a._)("div",Je,(0,r.zw)(n.name),1),(0,a.wy)((0,a._)("input",{class:"parameter__input text-input",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.parameter=e),onChange:t[1]||(t[1]=(...e)=>i.parameterChanged&&i.parameterChanged(...e)),onKeypress:t[2]||(t[2]=(...e)=>i.onlyNumber&&i.onlyNumber(...e))},null,544),[[o.nr,l.parameter]])])}var Ye={name:"ParameterText",props:{value:Number,name:String},data(){return{parameter:this.value}},watch:{value(e){this.parameter=e}},methods:{parameterChanged(){this.$emit("parameter-changed",this.parameter)},onlyNumber(e){let t=e.keyCode?e.keyCode:e.which;(t<48||t>57)&&e.preventDefault()}}};const qe=(0,Q.Z)(Ye,[["render",He]]);var Ve=qe,Xe={name:"ParameterPart",components:{ParameterText:Ve},props:{pN:Number,pK:Number,pB:Number,hasDocuments:Boolean,hasOntology:Boolean},data(){return{N:this.pN,K:this.pK,B:this.pB}},watch:{pN(e){this.N=e},pK(e){this.K=e},pB(e){this.B=e}},computed:{canRanking(){return this.hasOntology&&this.hasDocuments}},methods:{changeN(e){this.N=e,this.$emit("changed-n",this.N)},changeK(e){this.K=e,this.$emit("changed-k",this.K)},changeB(e){this.B=e,this.$emit("changed-b",this.B)},rankingAll(){0===this.N||parseInt(this.N)||this.changeN(0),0===this.K||parseInt(this.K)||this.changeK(0),0===this.B||parseInt(this.B)||this.changeB(0),this.$emit("ranking-all")}}};const Ge=(0,Q.Z)(Xe,[["render",Te]]);var Qe=Ge,et={name:"MainPart",components:{LoadPart:Ue,ParameterPart:Qe,DocumentPart:be},data(){return{errors:[],N:10,K:10,B:1,ontology:null,documents:{}}},watch:{N(e){if(0===e||parseInt(e))for(let t in this.documents)this.documents[t].attachOntology(this.ontology,e);else this.changeN(0)}},methods:{updateOntology(e){this.ontology=e;for(let t in this.documents)this.documents[t].attachOntology(this.ontology,this.N)},pushDocument(e){this.ontology&&e.attachOntology(this.ontology,this.N),this.documents[e.id]=e},findRank(e){this.documents[e].findRank(this.N,this.K,this.B)},rankingAll(){for(let e in this.documents)this.documents[e].findRank(this.N,this.K,this.B)},removeDocument(e){delete this.documents[e]},changeN(e){this.N=e},changeK(e){this.K=e},changeB(e){this.B=e},outputError(e){let t=new B(e);this.errors.push(t),setTimeout((()=>{this.removeError(t.id)}),4e3)},removeError(e){const t=this.errors.findIndex((t=>t.id==e));-1!==t&&this.errors.splice(t,1)}}};const tt=(0,Q.Z)(et,[["render",x]]);var nt=tt,ot={name:"App",components:{MainPart:nt}};const at=(0,Q.Z)(ot,[["render",s]]);var st=at;(0,o.ri)(st).mount("#app")}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,o,a,s){if(!o){var r=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],s=e[c][2];for(var l=!0,i=0;i<o.length;i++)(!1&s||r>=s)&&Object.keys(n.O).every((function(e){return n.O[e](o[i])}))?o.splice(i--,1):(l=!1,s<r&&(r=s));if(l){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[o,a,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={826:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,s,r=o[0],l=o[1],i=o[2],d=0;if(r.some((function(t){return 0!==e[t]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(i)var c=i(n)}for(t&&t(o);d<r.length;d++)s=r[d],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(c)},o=self["webpackChunkorod"]=self["webpackChunkorod"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(1681)}));o=n.O(o)})();
//# sourceMappingURL=index.77d2bd00.js.map